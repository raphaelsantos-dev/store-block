<html xmlns="http://www.w3.org/1999/xhtml">
<head></head>
<body>
    <nav>
        <select id="select-clients" onchange="createTable(this.options[this.selectedIndex].value)">
            <option value="">Clientes</option>
            <option value="4125699">Dental Cremer</option>
        </select>
    </nav>
    <table>
        <thead>
            <tr>
                <th>Lista</th>
                <th>Tarefa</th>
                <th>Respons√°vel</th>
                <th>Progresso</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody class="js--table-tasks">
        </tbody>
    </table>
    <script src="https://io.vtex.com.br/front-libs/jquery/1.8.3/jquery-1.8.3.min.js?v=1.4.1655.2282"></script>
    <script>
        function createTable(client) {
            $('.js--table-tasks').html('');
            var settingsFolder = {
                "async": true,
                "crossDomain": true,
                "url": `https://api.clickup.com/api/v2/folder/${client}/list?archived=false`,
                "method": "GET",
                "headers": {
                    "authorization": "pk_3047399_2FTC3GM5EIZ6A7T38XGI929NMP5NOJJ9"
                }
            };
            $.ajax(settingsFolder).done(function (response) {
    
                var lists = response.lists;
                $.each(lists, function (index, value) {
    
                    var settingsList = {
                        "async": true,
                        "crossDomain": true,
                        "url": `https://api.clickup.com/api/v2/list/${value.id}/task?include_closed=true`,
                        "method": "GET",
                        "headers": {
                            "authorization": "pk_3047399_2FTC3GM5EIZ6A7T38XGI929NMP5NOJJ9",
                            "content-type": "application/json"
                        },
                        "processData": false
                    };
                    $.ajax(settingsList).done(function (response) {
    
                        var tasks = response.tasks;
                        $.each(tasks, function (index, value) {
                            $('.js--table-tasks').append(`
                                <tr>
                                    <td>${value.list.name}</td>
                                    <td>${value.name}</td>
                                    <td>${value.assignees[0].username}</td>
                                    <td>${value.custom_fields[0].value.current} %</td>
                                    <td>${value.status.status}</td>
                                </tr>
                            `);
                        });
                    });
                });
            });
        }
    </script>
</body>
</html>